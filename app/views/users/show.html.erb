<h1><%= @user.name %>のプロフィール</h1>
<% if @user.profile_image? %>
<img src="<%= @user.profile_image.url %>" height=150 width=150 alt="<%= @user.name %>'s profile image" />
<%else%>
    <img src="/assets/default.png" height=150 width=150 alt="<%= @user.name %>'s profile image" />
<%end%>
<p>年齢: <%= @user.age %></p>
<p>学年: <%= @user.academic_year %></p>
<p>学部: <%= @user.department %></p>
<p>出身地: <%= @user.hometown %></p>
<p>プロフィール: <%= @user.profile %></p>
<p>学部: <%= @user.department %></p>
<p>緯度: <%= @user.latitude %></p>
<p>経度: <%= @user.longitude %></p>
<% if @user.id == current_user.id %>
    <p><%= link_to 'myプロフィール編集', edit_user_path(current_user) %></p>
    <%= form_with url: users_init_path, method: :post do %>
    <%= submit_tag 'init location' %>
    <% end %>
    <%= form_with url: users_update_path, method: :post, id: "location_form" do %>
    <%= hidden_field_tag :latitude %>
    <%= hidden_field_tag :longitude %>
    <%= submit_tag 'Send Location' %>
<% end %>

<script>
  document.addEventListener("DOMContentLoaded", function() {
    if (navigator.geolocation) {
      navigator.geolocation.getCurrentPosition(function(position) {
        document.getElementsByName("latitude")[0].value = position.coords.latitude;
        document.getElementsByName("longitude")[0].value = position.coords.longitude;
      });
    } else {
      alert("Geolocation is not supported by this browser.");
    }
  });
</script>
<% else %>
    <p><%= link_to 'チャットを始める', chat_path(@user.id), class: "ml-3" %></p>
<% end %>
